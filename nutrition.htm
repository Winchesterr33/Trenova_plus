<script>
document.addEventListener('DOMContentLoaded', function(){
  const form = document.getElementById('calcForm');
  const resultDiv = document.getElementById('result');

  form.addEventListener('submit', function(e){
    e.preventDefault();

    const age = Number(document.getElementById('age').value);
    const height = Number(document.getElementById('height').value);
    const weight = Number(document.getElementById('weight').value);
    const sex = document.getElementById('sex').value;
    const activity = Number(document.getElementById('activity').value);
    const goal = document.getElementById('goal').value;

    if(!age || !height || !weight) return;

    // BMR –ø–æ —Ñ–æ—Ä–º—É–ª–µ –ú–∏—Ñ—Ñ–ª–∏–Ω–∞-–°–∞–Ω –ñ–µ–æ—Ä–∞
    let bmr = (sex === '–º') 
      ? 10*weight + 6.25*height - 5*age + 5
      : 10*weight + 6.25*height - 5*age - 161;

    // –£–º–Ω–æ–∂–∞–µ–º –Ω–∞ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
    const activityFactor = [1.2,1.375,1.55,1.725,1.9][activity-1];
    let tdee = bmr * activityFactor;

    // –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ–º –ø–æ–¥ —Ü–µ–ª—å
    if(goal === '–ø–æ—Ö—É–¥–µ–Ω–∏–µ') tdee *= 0.85;
    if(goal === '–Ω–∞–±–æ—Ä') tdee *= 1.10;

    // –ë–µ–ª–∫–∏, –∂–∏—Ä—ã, —É–≥–ª–µ–≤–æ–¥—ã
    const protein = Math.round(weight * 1.8); // –≥
    const fat = Math.round(weight * 0.8); // –≥
    const carbs = Math.round((tdee - (protein*4 + fat*9))/4); // –≥

    const slowCarbs = Math.round(carbs*0.65);
    const simpleCarbs = carbs - slowCarbs;

    const plantFat = Math.round(fat*0.65);
    const animalFat = fat - plantFat;

    resultDiv.style.display = 'block';
    resultDiv.innerHTML = `
      üî• <strong>–°—É—Ç–æ—á–Ω–∞—è –Ω–æ—Ä–º–∞:</strong> ${Math.round(tdee)} –∫–∫–∞–ª<br>
      üçó –ë–µ–ª–∫–∏: ${protein} –≥<br>
      ü•ë –ñ–∏—Ä—ã: ${fat} –≥ (—Ä–∞—Å—Ç–∏—Ç–µ–ª—å–Ω—ã–µ: ${plantFat} –≥, –∂–∏–≤–æ—Ç–Ω—ã–µ: ${animalFat} –≥)<br>
      üçû –£–≥–ª–µ–≤–æ–¥—ã: ${carbs} –≥ (–º–µ–¥–ª–µ–Ω–Ω—ã–µ: ${slowCarbs} –≥, –ø—Ä–æ—Å—Ç—ã–µ: ${simpleCarbs} –≥)
    `;
  });
});
</script>
